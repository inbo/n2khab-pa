# Resultaten

## Spreiding van de scores per vraag

```{r message=FALSE, eval=FALSE}
actie26_sheet <- gs_key("1iaHBHlVNh9Cw35_9DYb0WDxmVJgpOEck_wBcFWVvsfk")
tab_colnames <- 
    actie26_sheet %>% 
        gs_read(ws = "EvaluatieMilieudrukkenScores",
                range = "A1:Y1",
                col_names = FALSE) %>% 
        t %>% 
        as.vector
actie26_sheet %>% 
    gs_read(ws = "EvaluatieMilieudrukkenScores",
            range = cell_cols(1:25),
            skip = 2,
            col_names = tab_colnames,
            col_types = str_c("c", str_c(rep("cii", 8), collapse = ""))
            ) %>% 
    gather(key = "Onderwerp", value = "Waarde", 2:25) %>% 
    mutate(Milieudruk = factor(Milieudruk),
           Vraag = str_extract(Onderwerp, "\\w+") %>% as.factor,
           Antwoordtype = ifelse(
               str_detect(Onderwerp, ":S"),
               "Score",
               ifelse(str_detect(Onderwerp, ":B"), 
                      "Betrouwbaarheid",
                      "Uitleg")
               ) %>% 
               factor(levels = c("Score", "Betrouwbaarheid", "Uitleg"))
           ) %>%
    select(Milieudruk, Vraag, Antwoordtype, Waarde) %>% 
    write_vc("actie26", 
             sorting = c("Milieudruk", "Vraag", "Antwoordtype"))
```

```{r}
actie26 <- read_vc("actie26")
levels(actie26$Vraag) <- 
    c("A1_problematiek",
      "A2a_actieradius",
      "A2b_geogr_spreiding",
      "A4_complexiteit",
      "B2b_tekort_beleidsinstrum",
      "M1_bronger_maatreg",
      "T1_informatie",
      "T4_grenswaarden")
```



```{r eval=FALSE}
actie26 %>% 
    str(give.attr = FALSE)
```

```{r eval=FALSE}
actie26 %>% 
    spread(key = Antwoordtype, value = Waarde) %>% 
    summarise(
        Score_NA = sum(is.na(Score)),
        Betrouwbaarheid_NA = sum(is.na(Betrouwbaarheid)),
        Uitleg_NA = sum(is.na(Uitleg)),
    )
```

Figuur \@ref(fig:scores) geeft weer hoe de scores verdeeld zijn over de verschillende vragen. We stellen vast:

- de spreiding over scores loopt uiteen tussen vragen: soms is de spreiding meer gelijkmatig, soms met nadruk op één specifieke score (bv. vraag M1);
- bij sommige vragen ontbreken milieudrukken met een score 0;
- de meest frequent gescoorde waarde verschilt tussen de vragen.

De verschillende vragen leveren dus complementaire informatie op die een antwoord kan geven over de nood aan een programmatische aanpak voor elk van de verschillende milieudrukken.  

```{r scores, fig.width=6, fig.height=5, warning=FALSE, fig.cap="Frequentie van de scores (van 0 tot 3) per vraag."}
actie26 %>% 
    filter(Antwoordtype == "Score") %>% 
    mutate(Waarde = factor(Waarde)) %>% 
    ggplot(aes(x = Waarde)) +
    geom_histogram(stat = "count", 
                   fill = "springgreen4") +
    facet_wrap(~Vraag) +
    labs(x = "Score", y = "Aantal milieudrukken")
```

Figuur \@ref(fig:betrouw) toont de verdeling van de betrouwbaarheid van de antwoorden (scores), waarbij we opmerken:

- er zijn geen antwoorden met een betrouwbaarheid '0'. Dit betekent dat er minstens enige kennisbasis was om een antwoord te geven;
- er zijn een beperkter aantal gevallen met betrouwbaarheid '1', waarvoor het antwoord en de score best kritisch worden nagekeken door andere experten;
- de verdeling tussen betrouwbaarheid '2' en '3' varieert tussen de vragen (3 is het maximum, dus met een grote zekerheid).
    - Er is vaak een score 2 gegeven, wat betekent dat er een redelijke inschatting kon worden gegeven, maar dat nazicht in sommige gevallen tot een bijstelling zou kunnen leiden.
    - Alleen voor vraag A1 is de betrouwbaarheid vaker als '3' ingeschat; d.i. wanneer de kennis van de habitatexperten voor een milieudruk voldoende toereikend is ingeschat.

```{r betrouw, fig.height=2, fig.width=6, warning=FALSE, fig.cap="Verdeling van de betrouwbaarheid (van 0 tot 3) van de score per vraag."}
actie26 %>% 
    filter(Antwoordtype == "Betrouwbaarheid") %>% 
    mutate(Waarde = factor(Waarde)) %>% 
    ggplot(aes(x = Vraag, fill = Waarde)) +
    geom_bar(stat = "count") +
    scale_fill_manual(values = c("tomato", "orange", "springgreen4")) +
    coord_flip() +
    labs(x = "Aantal milieudrukken", fill = "Betrouwbaarheid")
```


## Correlatie tussen scores

```{r}
actie26_scores <- 
    actie26 %>% 
    filter(Antwoordtype == "Score") %>% 
    select(-Antwoordtype) %>% 
    mutate(Waarde = as.integer(Waarde)) %>% 
    spread(key = Vraag, value = Waarde)
```

De (ordinale) Kendall-correlatie tussen de vragen (op basis van de gegeven scores) is overwegend beperkt (Figuur \@ref(fig:corr)). We merken wel de volgende hogere (positieve) correlaties op:

- tussen A1_problematiek en A2b_geogr_spreiding;
- tussen A1_problematiek en T4_grenswaarden;
- tussen A4_complexiteit en A2a_actieradius;
- tussen A4_complexiteit en A2b_geogr_spreiding.

Dit betekent dat deze duo's van criteria telkens op een eerder gelijkaardige manier de milieudrukken zouden rangschikken.
Dit betekent echter niet automatisch dat de relevantie van elk zo'n criterium voor de rangschikking kleiner is.
Ze kunnen nog steeds, omwille van hun inhoudelijke betekenis, elk evenveel -- of volgens een gekozen sleutel -- *meewegen* op de rangschikking.

```{r corr, warning=FALSE, fig.width=10, fig.height=10, fig.cap="Kendall correlatie en 'jittered' scatterplots van de relatie tussen de vragen."}
actie26_scores %>% 
    select(-Milieudruk) %>% 
    ggpairs(upper = list(continuous = GGally::wrap("cor", method = "kendall")),
            lower = list(continuous = GGally::wrap("points", 
                                                   size = 0.5, 
                                                   alpha = 0.4, 
                                                   position = position_jitter(width = 0.2, height = 0.2)))
            ) %>% 
        print(progress = FALSE)
```

## Rangschikking van milieudrukken

Er zijn verschillende manieren om de milieudrukken te rangschikken op basis van de scores:

- de meest zinvolle lijkt dat het beleid zelf aangeeft welke vragen meer zouden moeten meespelen dan andere, uitgedrukt als (relatieve) gewichten, zodat op basis daarvan een **gewogen eindscore** kan worden berekend;
- een alternatief is om elke vraag evenveel te wegen in de berekening van een zg. **ongewogen eindscore**;
- tenslotte is het mogelijk om automatische criteriaweging te laten gebeuren op basis van de correlatie tussen vragen, dus op basis van de variatie tussen de milieudrukken: een ordinatie-as (zie verder: PCA) vat dan informatie samen op een zodanige manier dat dit maximaal de -- voor alle vragen gezamenlijke -- variatie tussen de milieudrukken weergeeft.
Het lijkt ons echter minder zinvol om dit als basis voor rangschikking te gebruiken.
De resultaten van een PCA-ordinatie worden wel weergegeven, maar dan louter om de variatie tussen milieudrukken in relatie tot de vragen weer te geven.

In Tabel \@ref(tab:gewichttabel) wordt aangegeven welke gewichten worden gebruikt voor de berekening van een gewogen eindscore.

_XXXX Als we gewichten gaan gebruiken, wordt de onderstaande tabel best verhuisd naar een hoofdstuk 'methoden'._

```{r gewichttabel}
gewichten <- 
    tribble(
      ~Vraag,           ~Gewicht,
      "A1_problematiek", 10,
      "A2a_actieradius", 2,
      "A2b_geogr_spreiding", 5,
      "A4_complexiteit", 4,
      "B2b_tekort_beleidsinstrum", 7,
      "M1_bronger_maatreg", 5,
      "T1_informatie", 5,
      "T4_grenswaarden", 2
) %>% 
    mutate(Vraag = factor(Vraag))
gewichten %>% 
    kable(caption = "Gekozen gewichten per vraag. De waarden zijn relatief te beschouwen.")
```

Tabel \@ref(tab:eindscores) geeft de berekende gewogen en ongewogen eindscores weer (gewogen en ongewogen gemiddelde score per milieudruk). Tevens wordt een rangnummer weergegeven per milieudruk, voor elk van de scores.

\scriptsize

```{r eindscores, message=FALSE, results='asis'}
actie26_rang <- 
    actie26 %>% 
    filter(Antwoordtype == "Score") %>% 
    inner_join(gewichten) %>% 
    mutate(Waarde = as.integer(Waarde),
           Gewogen = Waarde * Gewicht) %>%  
    group_by(Milieudruk) %>% 
    summarise(Eindscore_gewogen = sum(Gewogen) / sum(Gewicht),
              Eindscore_ongewogen = mean(Waarde)
              ) %>% 
    mutate(Rang_gewogen = rank(Eindscore_gewogen * (-1), 
                                 ties.method = "min"),
           Rang_ongewogen = rank(Eindscore_ongewogen * (-1), 
                                 ties.method = "min")
           )
actie26_rang %>% 
    arrange(Rang_gewogen, 
            Rang_ongewogen) %>% 
    pandoc.table(
      caption = "(\\#tab:eindscores)Eindscores en rangschikking van milieudrukken.",
      split.table = Inf ,
     # split.cells = c(30,50),
     justify = "left"
    )
    # kable(caption = "Eindscores en rangschikking van milieudrukken.")
```

\normalsize

```{r message=FALSE}
actie26_scores_kort <- 
    actie26_scores %>% 
    inner_join(actie26_rang) %>% 
    tidyr::extract(Milieudruk,
                    c("Nummer", "String"),
               "([\\w\\.]+)\\s.+ (stikstof|fosfor|)"
            ) %>% 
    mutate(String = ifelse(String == "stikstof", "N",
                           ifelse(String == "fosfor", "P", String))) %>% 
    tidyr::unite("Milieudruk_kort", c("Nummer", "String"), sep = "")
# actie26_scores_kort %>% str
```

We stellen vast dat er -ondanks de weging- een sterke relatie bestaat tussen de ongewogen en de gewogen rangschikking (Figuur \@ref(fig:grafiek-eindscores)).
De gewogen rangschikking resulteert echter in minder _ex aequo_'s tussen milieudrukken dan de ongewogen rangschikking, wat een bijkomend voordeel is.


```{r grafiek-eindscores, fig.width=8, fig.height=6, fig.cap="Grafische rangschikking van milieudrukken volgens gewogen en ongewogen score."}
actie26_scores_kort %>% 
    ggplot(aes(x = Eindscore_ongewogen, 
               y = Eindscore_gewogen, 
               label = Milieudruk_kort)) +
    geom_point(size = 3, shape = 21, fill = "springgreen4") +
    geom_text(size = 3, nudge_x = 0.05)
```


```{r pca, message=FALSE}
actie26_pca <- 
    actie26_scores_kort %>% 
    column_to_rownames(var = "Milieudruk_kort") %>% 
    select(1:8) %>% 
    rda() # dit doet een PCA, maar levert een vegan-compatibel object op (prcomp-functie niet)
```

```{r eval=FALSE}
actie26_pca %>% 
    ggscreeplot("both")
```

De principale-componentenanalyse (PCA) vat de variatie in de set van scores (milieudruk x vraag) samen met principale componenten.
Het onderstaande resultaat toont dat de eerste drie principale componenten (PC's) ongeveer drie kwart van de variatie verklaren.

```{r pca_stats}
actie26_pca %>% 
    summary %>% 
    .$cont %>% 
    .$importance
```



```{r scores_groter, message=FALSE, include=FALSE}
actie26_scores_rang_pca <- 
    actie26_pca %>% 
    scores(choices = 1:3) %>% 
    .$sites %>% 
    as.data.frame %>% 
    rownames_to_column(var = "Milieudruk_kort") %>% 
    mutate_at(.vars = 2:4, .funs = function(x) x*2) %>% 
    inner_join(actie26_scores_kort, .)
actie26_scores_rang_pca %>% str
```


```{r biplots, message = FALSE, warning=FALSE, include=FALSE}
basisbiplot1 <- 
    actie26_pca %>% 
    ggbiplot_vegan(choices = c(1,2),
                   # base_sizes = c(1,2,2),
                   # site_data = df,
                   site_geom = "blank"
                   # site_mapping = aes(colour = Hoofdtype, label = Vegcode)
) 
    # xlim(-3,3) +
    # ylim(-3,3) +
    # theme(legend.position = "none")

basisbiplot2 <- 
    actie26_pca %>% 
    ggbiplot_vegan(choices = c(1,3),
                   site_geom = "blank"
    )
```




De ordinatiediagrammen (biplots) in Figuren \@ref(fig:biplot12) en \@ref(fig:biplot13) zijn louter te zien als een verder visueel hulpmiddel om de milieudrukken te spreiden in een ruimte op basis van de vragen, en om de correlatie tussen vragen te zien.
Onderstaand zijn 2 biplots weergegeven (PC1+2 resp. PC1+3) waar de pijlen de relatie van de vragen met de PC's en hun onderlinge relatie vertegenwoordigen.
De milieudrukken zijn gekleurd volgens de gewogen eindscore.

```{r message = FALSE, warning=FALSE}
biplotopmaak <- list(
    scale_x_continuous(),
    scale_y_continuous(), 
    theme_bw())

bp12 <- 
    basisbiplot1 +
    list(actie26_scores_rang_pca,
         aes(x = PC1, y = PC2),
         geom_point(aes(fill = Eindscore_gewogen), size = 3, shape = 21),
         scale_fill_gradientn(colours = rev(topo.colors(25)))
        ) +
    biplotopmaak

bp13 <- 
    basisbiplot2 +
    list(actie26_scores_rang_pca,
         aes(x = PC1, y = PC3),
         geom_point(aes(fill = Eindscore_gewogen), size = 3, shape = 21),
         scale_fill_gradientn(colours = rev(topo.colors(25)))
        ) +
    biplotopmaak
```



```{r biplot12, fig.width=10, fig.height=10, fig.cap="PCA biplot van de principale componenten 1 en 2. De kleurgradiënt is volgens de gewogen eindscore."}
bp12 +
    list(geom_text(aes(label = Milieudruk_kort), size = 3, vjust = 2)
        )
```


```{r biplot13, fig.width=10, fig.height=10, fig.cap="PCA biplot van de principale componenten 1 en 3. De kleurgradiënt is volgens de gewogen eindscore."}
bp13 +
    list(geom_text(aes(label = Milieudruk_kort), size = 3, vjust = 2)
        )
```





